<!doctype html>

<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="main.css">
    <link href='https://fonts.googleapis.com/css?family=Antic' rel='stylesheet' type='text/css'>
    <script>
    </script>
</head>

<body>
<section>
    <header>
        <img src="polymer-logo.svg">

        <h1>Polymer - Redux</h1>
    </header>

    <article>

        <div class="content-container">
            <p>
                With the rise of <a href="https://en.wikipedia.org/wiki/Single-page_application">SPA</a> the complexity
                of web applications exploded. If you still think that the IE6
                <a href="http://www.superstarcoders.com/blogs/posts/ie6-ie7-peekaboo-bug-fix.aspx">peekaboo</a> css
                bug was nasty, wait until you're faced with some weirdness in your SPA application and are bug hunting
                for days. You wish you could upload your site to <a href="stackoverflow.com">stackoverflow.com</a> (that
                is what I always wish for).<br>
                <br>
                Luckily, there are two projects out there that aim at simplification

                    <ol>
                        <li> <a href="https://github.com/rackt/redux">Redux</a> - a brilliant architecture which simplifies
                                state maintenance</li>
                        <li> <a href="https://www.polymer-project.org">Polymer</a> -
                            a back-to-nature approach that puts elements back at the center of the universe</li>
                    </ol>


                Of course frameworks like <a href="https://facebook.github.io/react/">React</a> and <a
                href="https://angularjs.org/">Angular</a> are great too, but why invent a whole new concepts,
                while the DOM itself has a lot of framework type concepts just built into it:

                <ol>
                    <li>Component model (custom element)</li>
                    <li>Concept of data flow (attributes/properties and events)
                    <li>declarative syntax (HTML)</li>
                </ol>

                Anyway, below I'll explain how I've used a single store, no two-way data-binding, actions and reducers in
                Polymer. You can visit the DEMO <a href="./demo">here</a> and find the code on
                <a href="https://github.com/scaljeri/polymer-redux">github</a>
            </p>

            <h2>Demo site</h2>
            <p>
                For the purpose of this exercise I've written a <a href="./demo">Stock ticker application</a>. As you can
                see in the demo you can search for ticker symbols. Now if no stock symbol pops up in your mind right now,
                here are some suggestions

                <ol>
                    <li><a href="./demo/?q=polymer">polymer</a> - random generated data</li>
                    <li><a href="./demo/?q=aapl">Apple - aapl</a></li>
                    <li><a href="./demo/?q=goog">Google - goog</a></li>
                    <li><a href="./demo/?q=fb">Facebook - fb</a></li>
                    <li><a href="./demo/?q=rdsa.as">Shell - rdsa.as</a></li>
                </ol>

                At any time you can save the current state and hit reload without loosing any data.
                The application will load its state back from Firebase and re-initializes.
                With Redux you almost get this functionality for free :)<br>
                <br>
                NOTE: If the demo doesn't work, make sure you're using an up<span class="up2date">2</span>date browser,
                like <a href="https://www.google.com/chrome/browser/canary.html">Chrome Canary</a>!!
            </p>

            <h2>Single source of truth</h2>

            <p class="first-dark-blue">
                In Polymer everything is an element, for example, an
                <a href="https://elements.polymer-project.org/elements/iron-ajax">AJAX call</a> can be expressed in HTML.
                There is an <a href="https://elements.polymer-project.org/">element</a> for everything.
                <br>

                So, in the main component of the demo app
                (<a href="https://github.com/scaljeri/polymer-redux/blob/master/app/html/stock-app.html">stock-app.html</a>)
                I connect the reducers with the store

                <pre class="demo-code"><span style='color:#7f0055; '>&lt;</span><span style='color:#7f0055; '>app-store</span> id=<span style='color:#2a00ff; '>"store"</span>
           state=<span style='color:#2a00ff; '>"{{state}}"</span>
           reducer=<span style='color:#2a00ff; '>"[[reducer]]"</span><span style='color:#7f0055; '>></span><span style='color:#7f0055; '>&lt;/</span><span style='color:#7f0055; '>app-store</span><span style='color:#7f0055; '>></span></pre>

                I pass the <b>reducers</b> to the store and with two-way data-binding
                <pre>{{state}}</pre>I gain access to the state. From there on I pass state properties to child elements
                only by one-way data-binding.
            </p>

            <h2>Actions</h2>

            <p class="first-dark-red">
                Through attributes components receive parts of the state. In order to change the state
                each component includes the store and can dispatches actions

                <pre class="demo-code"><span style='color:#7f0055; '>&lt;</span><span style='color:#7f0055; '>app-store</span> id=<span style='color:#2a00ff; '>"store"</span><span style='color:#7f0055; '>></span><span style='color:#7f0055; '>&lt;/</span><span style='color:#7f0055; '>app-store</span><span style='color:#7f0055; '>></span>
...
this.$.store.dispatch('CHANGE_QUERYSTRING',
           {queryString: this.queryString});
</pre>

                The store passes the action to the reducers
            </p>

            <h2>Reducers</h2>

            <p>
                Reducers are pure function (wrapped in an element of course). They don't change the state
                object, but return a complete new state object
                <br><br>
            <pre class="demo-code"><span style='color:#800000; font-weight:bold; '>class</span> QuoteReducer <span style='color:#800080; '>{</span>
    transform<span style='color:#808030; '>(</span>state<span style='color:#808030; '>,</span> action<span style='color:#808030; '>,</span> <span style='color:#797997; '>input</span><span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
        <span style='color:#800000; font-weight:bold; '>switch</span> <span style='color:#808030; '>(</span>action<span style='color:#808030; '>)</span> <span style='color:#800080; '>{</span>
            <span style='color:#800000; font-weight:bold; '>case</span> <span style='color:#800000; '>'</span><span style='color:#0000e6; '>QUOTE_CHANGE</span><span style='color:#800000; '>'</span><span style='color:#800080; '>:</span>
                <span style='color:#800000; font-weight:bold; '>return</span> <span style='color:#797997; '>Object</span><span style='color:#808030; '>.</span>assign<span style='color:#808030; '>(</span><span style='color:#800080; '>{</span><span style='color:#800080; '>}</span><span style='color:#808030; '>,</span> state<span style='color:#808030; '>,</span>
                            <span style='color:#800080; '>{</span>quote<span style='color:#800080; '>:</span> <span style='color:#797997; '>input</span><span style='color:#808030; '>.</span>quote<span style='color:#800080; '>}</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            <span style='color:#800000; font-weight:bold; '>default</span><span style='color:#800080; '>:</span>
                <span style='color:#800000; font-weight:bold; '>return</span> state<span style='color:#800080; '>;</span>
        <span style='color:#800080; '>}</span>
    <span style='color:#800080; '>}</span>
<span style='color:#800080; '>}</span>
</pre>

            Finally, when the reducers are ready, the store updates its state and Polymer makes sure
            that the changes flow (from top to bottom) through the application.
            </p>

        </div>
    </article>
</section>
</body>
</html>
