<link rel="import" href="../../bower/polymer/polymer.html">
<link rel="import" href="reducers/quote-reducer.html">
<link rel="import" href="reducers/ticker-reducer.html">
<link rel="import" href="reducers/quote-reducer.html">

<dom-module id="app-reducer">
    <template>
        <quote-reducer></quote-reducer>
        <ticker-reducer></ticker-reducer>
    </template>
    <script>
        let actions = [], reducers = [];

        (function () {
            class AppReducer {
                beforeRegister() {
                    this.is = 'app-reducer';
                }

                ready() {
                    // Note that `this.children` is a NodeList (host object) not an Array
                    for( let i = 0; i < this.children.length; i++) {
                        actions.push(...this.children[i].actions);
                        reducers.push(this.children[i]);
                    };
                }

                get actions() {
                    return actions;
                }

                transform(state, action, data) {
                    reducers.forEach( (reducer) => {
                        state = reducer.transform(state, action, data);
                    });

                    return state;
                }
            }

            Polymer(AppReducer);
        })();
    </script>
</dom-module>
