<link rel="import" href="../../../bower/polymer/polymer.html">
<link rel="import" href="../../../bower/iron-a11y-keys/iron-a11y-keys.html">
<link rel="import" href="../../../bower/paper-input/paper-input.html">
<link rel="import" href="../../../bower/paper-button/paper-button.html">

<link rel="import" href="../app-store.html">

<dom-module id="stock-search">
    <style>
        /* inject:css */
        :host {
            display: flex;
            justify-content: center;

            --paper-input-container-label: {
                color: lightgray;
            }
            --paper-input-container-label-focus: {
                color: #000;
            }
            --paper-input-container-underline-focus: {
                background: green;
            }
        }
    </style>
    <template>
        <app-store id="store"></app-store>

        <div class="search-wrapper">
            <iron-a11y-keys keyEventTarget="tickerInput" keys="enter" on-keys-pressed="handleSymbolChange"></iron-a11y-keys>
            <paper-input-container>
                <label>Ticker symbol</label>
                <input id="stock-name" is="iron-input" bind-value="{{localSymbol}}">
            </paper-input-container>
            <paper-button id="tickerInput" on-click="handleSymbolChange" class="search">Search</paper-button>
        </div>
    </template>
    <script>
        (function () {
            'use strict';

            class StockSearch {
                beforeRegister() {
                    this.is = 'stock-search';

                    this.properties = {
                        symbol: {
                            type: String,
                            notify: true,
                            observer: 'handleUpdateSymbol'
                        }
                    };
                }

                handleUpdateSymbol() {
                    this.localSymbol = this.symbol;
                }

                handleSymbolChange() {
                    let store = this.$.store,
                        symbol = this.$['stock-name'].value;

                    store.dispatch('FILTER_SYMBOL_CHANGE', {symbol});
                }
            }

            Polymer(StockSearch);
        })();
    </script>
</dom-module>
